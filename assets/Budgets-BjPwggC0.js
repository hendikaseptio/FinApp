import{j as e}from"./vendor-motion-DQ2oF2Tq.js";import{r as u,c as V,a9 as q,aa as G,O as F,ag as J,H as Q,N as X,af as Z,P as Y}from"./vendor-icons-BcfTGjTB.js";import{D as ee,B as te,L as ae,C as se,A as re,f as ie,g as le,a as ne,b as ce,c as oe,d as de,e as xe}from"./vendor-charts-D7ZIuN8r.js";import{g as j,a as pe}from"./index-DUyIjFaj.js";import"./vendor-firebase-4Wekvqsq.js";se.register(re,ie,le,ne,ce,oe,de,xe);const be=({budgets:z=[],transactions:w=[],onAddBudget:R,onEditBudget:A,onDeleteBudget:B,activeMonth:y,activeYear:v,onDeleteMultiple:O})=>{const[i,H]=u.useState("pie"),[l,$]=u.useState("active"),[c,k]=u.useState(!1),[d,p]=u.useState([]),h=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),{activeBudgets:I,archivedBudgets:T}=u.useMemo(()=>{const t=new Date(v,y,1).toISOString().split("T")[0],r=new Date(v,y+1,0).toISOString().split("T")[0],n=[],g=[];z.forEach(a=>{const o=a.startDate||"0000-00-00",m=a.endDate||"9999-12-31",C=o<r&&m>t,b=m<t,D=w.filter(x=>x.type==="expense"&&x.category===a.category&&x.date>=o&&x.date<=m).reduce((x,U)=>x+Number(U.amount),0),E={...a,dynamicSpent:D};C?n.push(E):b&&g.push(E)});const f=(a,o)=>(a.startDate||"").localeCompare(o.startDate||"");return{activeBudgets:n.sort(f),archivedBudgets:g.sort(f)}},[z,w,y,v]),s=l==="active"?I:T,L=s.reduce((t,r)=>t+(r.dynamicSpent||0),0),N={labels:s.map(t=>t.category),datasets:[{label:"Terpakai",data:s.map(t=>t.dynamicSpent||0),backgroundColor:s.map(t=>j(t.category)+(i==="pie"?"99":"44")),borderColor:s.map(t=>j(t.category)),borderWidth:2,borderRadius:i==="bar"?8:0,tension:.4,fill:i==="line",pointBackgroundColor:s.map(t=>j(t.category))}]},M=t=>{p(r=>r.includes(t)?r.filter(n=>n!==t):[...r,t])},W=()=>{d.length===s.length?p([]):p(s.map(t=>t.id))},_=()=>{O(d),k(!1),p([])},K=t=>{switch(t){case"monthly":return"Bulanan";case"weekly":return"Mingguan";case"yearly":return"Tahunan";case"custom":return"Kustom";default:return"Bulanan"}},P=t=>t?new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"short"}):"",S={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.9)",titleFont:{size:12,weight:"bold"},bodyFont:{size:12,weight:"black"},padding:12,cornerRadius:12,borderWidth:1,borderColor:"rgba(255, 255, 255, 0.1)",displayColors:!1,callbacks:{label:t=>` ${h(t.raw)}`}}},cutout:"75%",scales:i==="pie"?{}:{x:{grid:{display:!1},ticks:{color:"#94a3b8",font:{size:10,weight:"bold"}}},y:{display:!1,grid:{display:!1}}}};return e.jsxs("div",{className:"px-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:c?`Pilih (${d.length})`:"Anggaran"}),e.jsxs("div",{className:"flex items-center gap-2",children:[!c&&e.jsx("div",{className:"flex gap-1 bg-white/5 p-1 rounded-xl border border-white/10 mr-1",children:[{id:"pie",icon:e.jsx(V,{size:14})},{id:"bar",icon:e.jsx(q,{size:14})},{id:"line",icon:e.jsx(G,{size:14})}].map(t=>e.jsx("button",{onClick:()=>H(t.id),className:`p-2 rounded-lg transition-all ${i===t.id?"bg-primary text-background-dark shadow-lg shadow-primary/20":"text-slate-500 hover:text-white"}`,children:t.icon},t.id))}),c?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:W,className:"px-4 py-2 text-[10px] font-black uppercase tracking-widest text-primary hover:bg-primary/10 rounded-xl transition-all",children:d.length===s.length?"Batal Semua":"Semua"}),e.jsx("button",{onClick:()=>{k(!1),p([])},className:"px-4 py-2 text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white transition-all",children:"Batal"})]}):e.jsx("button",{onClick:()=>k(!0),className:"px-4 py-2 text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white transition-all bg-white/5 rounded-xl border border-white/10",children:"Pilih"})]})]}),c&&d.length>0&&e.jsxs("button",{onClick:_,className:"w-full bg-red-500 text-white font-black py-4 rounded-2xl flex items-center justify-center gap-2 shadow-xl shadow-red-500/20 animate-in slide-in-from-top duration-300 uppercase tracking-widest text-xs",children:[e.jsx(F,{size:18}),"Hapus ",d.length," Anggaran"]}),e.jsxs("div",{className:"flex gap-2 p-1 bg-white/5 rounded-2xl border border-white/10",children:[e.jsxs("button",{onClick:()=>$("active"),className:`flex-1 py-3 px-4 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2 ${l==="active"?"bg-white/10 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx(J,{size:14}),"Aktif (",I.length,")"]}),e.jsxs("button",{onClick:()=>$("archive"),className:`flex-1 py-3 px-4 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2 ${l==="archive"?"bg-white/10 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx(Q,{size:14}),"Arsip (",T.length,")"]})]}),e.jsxs("div",{className:"glass-card p-6 rounded-[2.5rem] flex flex-col items-center justify-center relative shadow-xl shadow-black/20 overflow-hidden",children:[e.jsx("div",{className:"w-full h-48 flex items-center justify-center relative",children:s.length>0?e.jsxs(e.Fragment,{children:[i==="pie"&&e.jsx(ee,{data:N,options:S}),i==="bar"&&e.jsx(te,{data:N,options:S}),i==="line"&&e.jsx(ae,{data:N,options:S}),i==="pie"&&e.jsxs("div",{className:"absolute flex flex-col items-center",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:"Total Pakai"}),e.jsx("p",{className:"text-lg font-black text-slate-100",children:h(L)})]})]}):e.jsx("div",{className:"size-full rounded-[2rem] border-4 border-dashed border-white/5 flex items-center justify-center text-center p-4",children:e.jsxs("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-[0.2em]",children:["Tidak Ada ",l==="active"?"Anggaran Aktif":"Arsip Anggaran"]})})}),i!=="pie"&&s.length>0&&e.jsxs("div",{className:"mt-4 text-center",children:[e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:["Total Terpakai ",l==="active"?"Saat Ini":"(Arsip)"]}),e.jsx("p",{className:"text-xl font-black text-primary",children:h(L)})]})]}),e.jsxs("div",{className:"space-y-4",children:[s.map(t=>{const r=t.dynamicSpent||0,n=Math.round(r/t.limit*100),g=n>100,f=n===100,a=n>=85,o=j(t.category),m=pe(t.iconName||"ShoppingBag",20),C=w.some(D=>D.category===t.category),b=d.includes(t.id);return e.jsxs("div",{onClick:()=>c?M(t.id):null,className:`glass-card p-5 rounded-3xl border-white/5 relative group overflow-hidden transition-all ${b?"ring-2 ring-primary bg-primary/5":""} ${c?"cursor-pointer active:scale-[0.98]":""}`,children:[c&&e.jsx("div",{className:"absolute inset-0 bg-primary/5 pointer-events-none"}),l==="archive"&&e.jsx("div",{className:"absolute top-0 right-0 px-3 py-1 bg-white/5 text-[8px] font-black uppercase tracking-widest text-slate-500 rounded-bl-xl border-l border-b border-white/5",children:"Expired"}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsxs("div",{className:"flex gap-4",children:[c?e.jsx("div",{className:`size-12 rounded-xl border-2 flex items-center justify-center transition-all ${b?"bg-primary border-primary text-background-dark":"border-white/10 bg-white/5 text-transparent"}`,children:e.jsx(X,{size:20,strokeWidth:4})}):e.jsx("div",{className:"size-12 rounded-2xl flex items-center justify-center",style:{backgroundColor:`${o}1a`,color:o},children:m}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-100 capitalize",children:t.category}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded-md bg-white/5 text-slate-400 font-black uppercase tracking-tighter border border-white/5",children:K(t.period)}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider",children:[P(t.startDate)," - ",P(t.endDate)]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`font-black text-lg ${a?"text-red-400":"text-slate-100"}`,children:[n,"%"]})}),!c&&e.jsxs("div",{className:"flex items-center gap-2",children:[l==="active"&&e.jsx("button",{onClick:()=>A&&A(t),className:"size-8 glass-card border-white/10 rounded-full flex items-center justify-center text-white/50 hover:text-white hover:bg-white/5 transition-all opacity-0 group-hover:opacity-100",children:e.jsx(Z,{size:14})}),l==="archive"&&!C&&e.jsx("button",{onClick:()=>B&&B(t),className:"size-8 glass-card border-white/10 rounded-full flex items-center justify-center text-red-400 hover:text-red-300 hover:bg-white/5 transition-all opacity-0 group-hover:opacity-100",children:e.jsx(F,{size:14})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold",children:[e.jsxs("span",{className:"text-slate-400",children:["Terpakai dari ",h(t.limit)]}),e.jsx("span",{className:a?"text-red-400":"text-slate-200",children:h(r)})]}),e.jsx("div",{className:"h-2 w-full bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 rounded-full ${a?"bg-red-400":""}`,style:{width:`${Math.min(n,100)}%`,backgroundColor:a?void 0:o,boxShadow:`0 0 10px ${a?"rgba(248,113,113,0.3)":`${o}4d`}`}})}),a&&l==="active"&&e.jsx("p",{className:"text-[10px] text-red-400 font-bold animate-pulse",children:g?"Sudah melewati batas (Boncos)!":f?"Sudah mencapai batas!":"Hampir melewati batas!"})]})]},t.id)}),l==="active"&&e.jsxs("button",{onClick:R,className:"w-full glass-card border-dashed border-white/10 p-5 rounded-3xl flex items-center justify-center gap-2 text-slate-500 hover:text-primary transition-all group",children:[e.jsx(Y,{size:20,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Atur Anggaran Baru"})]})]})]})};export{be as default};
