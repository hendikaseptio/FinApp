import{j as e}from"./vendor-motion-CzpfVgIZ.js";import{r as u,c as U,ai as V,aj as q,a0 as L,_ as G,an as J,P as Q}from"./vendor-icons-CKU70MxI.js";import{D as X,B as Z,L as Y,C as ee,A as te,f as ae,g as se,a as re,b as ie,c as le,d as ne,e as ce}from"./vendor-charts-G8qzd-xA.js";import{g as j,a as oe}from"./index-CPd4PYJi.js";import"./vendor-firebase-4Wekvqsq.js";ee.register(te,ae,se,re,ie,le,ne,ce);const ge=({budgets:z=[],transactions:y=[],onAddBudget:P,onEditBudget:A,onDeleteBudget:B,activeMonth:w,activeYear:v,onDeleteMultiple:E})=>{const[i,F]=u.useState("pie"),[o,de]=u.useState("active"),[n,N]=u.useState(!1),[d,p]=u.useState([]),h=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),{activeBudgets:R,archivedBudgets:M}=u.useMemo(()=>{const t=new Date(v,w,1).toISOString().split("T")[0],r=new Date(v,w+1,0).toISOString().split("T")[0],l=[],g=[];z.forEach(a=>{const c=a.startDate||"0000-00-00",m=a.endDate||"9999-12-31",C=c<r&&m>t,b=m<t,D=y.filter(x=>x.type==="expense"&&x.category===a.category&&x.date>=c&&x.date<=m).reduce((x,K)=>x+Number(K.amount),0),$={...a,dynamicSpent:D};C?l.push($):b&&g.push($)});const f=(a,c)=>(a.startDate||"").localeCompare(c.startDate||"");return{activeBudgets:l.sort(f),archivedBudgets:g.sort(f)}},[z,y,w,v]),s=o==="active"?R:M,I=s.reduce((t,r)=>t+(r.dynamicSpent||0),0),k={labels:s.map(t=>t.category),datasets:[{label:"Terpakai",data:s.map(t=>t.dynamicSpent||0),backgroundColor:s.map(t=>j(t.category)+(i==="pie"?"99":"44")),borderColor:s.map(t=>j(t.category)),borderWidth:2,borderRadius:i==="bar"?8:0,tension:.4,fill:i==="line",pointBackgroundColor:s.map(t=>j(t.category))}]},O=t=>{p(r=>r.includes(t)?r.filter(l=>l!==t):[...r,t])},W=()=>{d.length===s.length?p([]):p(s.map(t=>t.id))},_=()=>{E(d),N(!1),p([])},H=t=>{switch(t){case"monthly":return"Bulanan";case"weekly":return"Mingguan";case"yearly":return"Tahunan";case"custom":return"Kustom";default:return"Bulanan"}},T=t=>t?new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"short"}):"",S={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.9)",titleFont:{size:12,weight:"bold"},bodyFont:{size:12,weight:"black"},padding:12,cornerRadius:12,borderWidth:1,borderColor:"rgba(255, 255, 255, 0.1)",displayColors:!1,callbacks:{label:t=>` ${h(t.raw)}`}}},cutout:"75%",scales:i==="pie"?{}:{x:{grid:{display:!1},ticks:{color:"#94a3b8",font:{size:10,weight:"bold"}}},y:{display:!1,grid:{display:!1}}}};return e.jsxs("div",{className:"px-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:n?`Pilih (${d.length})`:"Anggaran"}),e.jsxs("div",{className:"flex items-center gap-2",children:[!n&&e.jsx("div",{className:"flex gap-1 bg-white/5 p-1 rounded-xl border border-white/10 mr-1",children:[{id:"pie",icon:e.jsx(U,{size:14})},{id:"bar",icon:e.jsx(V,{size:14})},{id:"line",icon:e.jsx(q,{size:14})}].map(t=>e.jsx("button",{onClick:()=>F(t.id),className:`p-2 rounded-lg transition-all ${i===t.id?"bg-primary text-background-dark shadow-lg shadow-primary/20":"text-slate-500 hover:text-white"}`,children:t.icon},t.id))}),n?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:W,className:"px-4 py-2 text-[10px] font-black uppercase tracking-widest text-primary hover:bg-primary/10 rounded-xl transition-all",children:d.length===s.length?"Batal Semua":"Semua"}),e.jsx("button",{onClick:()=>{N(!1),p([])},className:"px-4 py-2 text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white transition-all",children:"Batal"})]}):e.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white transition-all bg-white/5 rounded-xl border border-white/10",children:"Pilih"})]})]}),n&&d.length>0&&e.jsxs("button",{onClick:_,className:"w-full bg-red-500 text-white font-black py-4 rounded-2xl flex items-center justify-center gap-2 shadow-xl shadow-red-500/20 animate-in slide-in-from-top duration-300 uppercase tracking-widest text-xs",children:[e.jsx(L,{size:18}),"Hapus ",d.length," Anggaran"]}),e.jsxs("div",{className:"glass-card p-6 rounded-[2.5rem] flex flex-col items-center justify-center relative shadow-xl shadow-black/20 overflow-hidden",children:[e.jsx("div",{className:"w-full h-48 flex items-center justify-center relative",children:s.length>0?e.jsxs(e.Fragment,{children:[i==="pie"&&e.jsx(X,{data:k,options:S}),i==="bar"&&e.jsx(Z,{data:k,options:S}),i==="line"&&e.jsx(Y,{data:k,options:S}),i==="pie"&&e.jsxs("div",{className:"absolute flex flex-col items-center",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:"Total Pakai"}),e.jsx("p",{className:"text-lg font-black text-slate-100",children:h(I)})]})]}):e.jsx("div",{className:"size-full rounded-[2rem] border-4 border-dashed border-white/5 flex items-center justify-center text-center p-4",children:e.jsxs("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-[0.2em]",children:["Tidak Ada ",o==="active"?"Anggaran Aktif":"Arsip Anggaran"]})})}),i!=="pie"&&s.length>0&&e.jsxs("div",{className:"mt-4 text-center",children:[e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:["Total Terpakai ",o==="active"?"Saat Ini":"(Arsip)"]}),e.jsx("p",{className:"text-xl font-black text-primary",children:h(I)})]})]}),e.jsxs("div",{className:"space-y-4",children:[s.map(t=>{const r=t.dynamicSpent||0,l=Math.round(r/t.limit*100),g=l>100,f=l===100,a=l>=85,c=j(t.category),m=oe(t.iconName||"ShoppingBag",20),C=y.some(D=>D.category===t.category),b=d.includes(t.id);return e.jsxs("div",{onClick:()=>n?O(t.id):null,className:`glass-card p-5 rounded-3xl border-white/5 relative group overflow-hidden transition-all ${b?"ring-2 ring-primary bg-primary/5":""} ${n?"cursor-pointer active:scale-[0.98]":""}`,children:[n&&e.jsx("div",{className:"absolute inset-0 bg-primary/5 pointer-events-none"}),o==="archive"&&e.jsx("div",{className:"absolute top-0 right-0 px-3 py-1 bg-white/5 text-[8px] font-black uppercase tracking-widest text-slate-500 rounded-bl-xl border-l border-b border-white/5",children:"Expired"}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsxs("div",{className:"flex gap-4",children:[n?e.jsx("div",{className:`size-12 rounded-xl border-2 flex items-center justify-center transition-all ${b?"bg-primary border-primary text-background-dark":"border-white/10 bg-white/5 text-transparent"}`,children:e.jsx(G,{size:20,strokeWidth:4})}):e.jsx("div",{className:"size-12 rounded-2xl flex items-center justify-center",style:{backgroundColor:`${c}1a`,color:c},children:m}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-100 capitalize",children:t.category}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded-md bg-white/5 text-slate-400 font-black uppercase tracking-tighter border border-white/5",children:H(t.period)}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-wider",children:[T(t.startDate)," - ",T(t.endDate)]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`font-black text-lg ${a?"text-red-400":"text-slate-100"}`,children:[l,"%"]})}),!n&&e.jsxs("div",{className:"flex items-center gap-2",children:[o==="active"&&e.jsx("button",{onClick:()=>A&&A(t),className:"size-8 glass-card border-white/10 rounded-full flex items-center justify-center text-white/50 hover:text-white hover:bg-white/5 transition-all opacity-0 group-hover:opacity-100",children:e.jsx(J,{size:14})}),o==="archive"&&!C&&e.jsx("button",{onClick:()=>B&&B(t),className:"size-8 glass-card border-white/10 rounded-full flex items-center justify-center text-red-400 hover:text-red-300 hover:bg-white/5 transition-all opacity-0 group-hover:opacity-100",children:e.jsx(L,{size:14})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold",children:[e.jsxs("span",{className:"text-slate-400",children:["Terpakai dari ",h(t.limit)]}),e.jsx("span",{className:a?"text-red-400":"text-slate-200",children:h(r)})]}),e.jsx("div",{className:"h-2 w-full bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 rounded-full ${a?"bg-red-400":""}`,style:{width:`${Math.min(l,100)}%`,backgroundColor:a?void 0:c,boxShadow:`0 0 10px ${a?"rgba(248,113,113,0.3)":`${c}4d`}`}})}),a&&o==="active"&&e.jsx("p",{className:"text-[10px] text-red-400 font-bold animate-pulse",children:g?"Sudah melewati batas (Boncos)!":f?"Sudah mencapai batas!":"Hampir melewati batas!"})]})]},t.id)}),o==="active"&&e.jsxs("button",{onClick:P,className:"w-full glass-card border-dashed border-white/10 p-5 rounded-3xl flex items-center justify-center gap-2 text-slate-500 hover:text-primary transition-all group",children:[e.jsx(Q,{size:20,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Atur Anggaran Baru"})]})]})]})};export{ge as default};
